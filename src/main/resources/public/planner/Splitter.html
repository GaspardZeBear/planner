<!doctype html>
<html lang="fr">
<head>
<title>Pdf Splitter</title>
<meta charset="utf-8">
<link rel="stylesheet" href="Custom.css">
<script type="text/javascript" src="Util.js"></script>

<script>

function pdfFun() {
    console.log("pdfFun")
}

var xhttpFiles = new XMLHttpRequest();
xhttpFiles.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       
       pdfFiles = JSON.parse(xhttpFiles.responseText);
       console.log("pdfFiles : " + JSON.stringify(pdfFiles))
       Util.buildFilesList("pdfFiles",pdfFiles,splitPdfFile);
       }
};
//http.open("GET", "Planning.txt", true);
xhttpFiles.open("GET", "/pdflist", true);
xhttpFiles.send();



function splitPdfFile(pdfFileName) {
  var xhttp = new XMLHttpRequest();
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
       console.log("Split over ")
       generatedFiles = JSON.parse(xhttp.responseText);
       console.log("pdfFiles : " + JSON.stringify(generatedFiles))
       listGeneratedFiles(generatedFiles)
    }
  };
  xhttp.open("GET", "/pdfsplit/"+pdfFileName, true);
  xhttp.send();
}

function listGeneratedFiles(generatedFiles) {
  var table=document.querySelector("#generatedFiles");
  table.innerHTML=""
  let thead = table.createTHead();
  let row = thead.insertRow();
  let th = document.createElement("th");
  let text = document.createTextNode("Generated");
  th.appendChild(text);
  row.appendChild(th);
  for (let f of generatedFiles) {
    let row=table.insertRow()
    let td=document.createElement("td")
    let text = document.createTextNode(f);
    td.appendChild(text);
    row.appendChild(td);
  }
}

</script>
</head>

<body>
    <h2>Choose PDF to split</h2>
    <div id="pdfFiles">
    </div>

    <h2>Generated PDF</h2>
    <table id="generatedFiles">
    </table>
    

    <h2>Details</h2>
    <table id="details">
    </table>
</body>
</html>